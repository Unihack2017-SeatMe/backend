{"version":3,"sources":["webpack:///webpack/bootstrap 5022bb346843c0a10367","webpack:///external \"mobx\"","webpack:///./src/index.js","webpack:///./src/setupServer.js","webpack:///external \"express\"","webpack:///external \"path\"","webpack:///external \"morgan\"","webpack:///external \"body-parser\"","webpack:///external \"socket.io\"","webpack:///external \"http\"","webpack:///./src/shared/socket-keys.js","webpack:///./src/shared/state/appState.jsx","webpack:///./src/shared/model/MapState.jsx","webpack:///./src/shared/model/LOCATIONS.js"],"names":["envPort","process","env","PORT","setupServer","createJsonFromMapState","mapState","allRoomData","values","map","roomData","port","app","express","server","http","Server","io","SocketIo","listen","undefined","console","log","use","logger","bodyParser","json","urlencoded","extended","get","req","res","hello","post","addRoomData","body","info","status","autorun","emit","on","socket","next","err","Error","locals","message","error","render","socketKeys","roomDataKey","allRoomDataKey","Map","MapState","constructor","initialRoomData","allRoomState","observable","setRoomData","set","id","allRoomGeoData","result","key","count","capacity","push","type","properties","name","LOCATIONS","geometry","coordinates"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;AC7DA,iC;;;;;;;;;;ACAA;AACA;AACA,IAAIA,UAAUC,QAAQC,GAAR,CAAYC,IAAZ,IAAoB,IAAlC;AACA,yEAAAC,CAAY,wEAAZ,EAAsBJ,OAAtB,E;;;;;;;;;;;;;;;;;;;;;;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAASK,sBAAT,CAAgCC,QAAhC,EAA0C;AACxC,SAAOA,SAASC,WAAT,CAAqBC,MAArB,GAA8BC,GAA9B,CACLC,YAAY;AACV,WAAOA,QAAP;AACD,GAHI,CAAP;AAKD;AACD,SAASN,WAAT,CAAqBE,QAArB,EAA+BK,IAA/B,EAAqC;;AAEnC,QAAMC,MAAM,+CAAAC,EAAZ;;AAEA,QAAMC,SAAS,4CAAAC,CAAKC,MAAL,CAAYJ,GAAZ,CAAf;;AAEA,QAAMK,KAAK,iDAAAC,CAASJ,MAAT,CAAX;;AAEAA,SAAOK,MAAP,CAAcR,IAAd,EAAoBS,SAApB,EAA+BA,SAA/B,EAA0C,MAAM;AAC9CC,YAAQC,GAAR,CAAY,4BAA4BX,IAAxC;AACD,GAFD;AAGA;AACA;AACAC,MAAIW,GAAJ,CAAQ,8CAAAC,CAAO,KAAP,CAAR;AACAZ,MAAIW,GAAJ,CAAQ,mDAAAE,CAAWC,IAAX,EAAR;AACAd,MAAIW,GAAJ,CAAQ,mDAAAE,CAAWE,UAAX,CAAsB,EAAEC,UAAU,KAAZ,EAAtB,CAAR;;AAEAhB,MAAIiB,GAAJ,CAAQ,GAAR,EAAa,CAACC,GAAD,EAAMC,GAAN,KAAc;AACzBA,QAAIL,IAAJ,CAAS,EAAEM,OAAO,OAAT,EAAT;AACD,GAFD;;AAIApB,MAAIqB,IAAJ,CAAS,UAAT,EAAqB,CAACH,GAAD,EAAMC,GAAN,KAAc;AACjCzB,aAAS4B,WAAT,CAAqBJ,IAAIK,IAAzB;AACAd,YAAQe,IAAR,CAAaN,IAAIK,IAAjB;AACAJ,QAAIM,MAAJ,CAAW,GAAX;AACD,GAJD;;AAMAC,EAAA,qDAAAA,CAAQ,MAAI;AACVrB,OAAGsB,IAAH,CACC,mEADD,EAEClC,uBAAuBC,QAAvB,CAFD;AAID,GALD;;AAOAW,KAAGuB,EAAH,CAAM,YAAN,EAAqBC,MAAD,IAAY;AAC9BpB,YAAQe,IAAR,CAAa,kBAAb;AACAK,WAAOF,IAAP,CACE,mEADF,EAEElC,uBAAuBC,QAAvB,CAFF;AAID,GAND;;AASA;AACAM,MAAIW,GAAJ,CAAQ,CAACO,GAAD,EAAMC,GAAN,EAAWW,IAAX,KAAoB;AAC1B,QAAIC,MAAM,IAAIC,KAAJ,CAAU,WAAV,CAAV;AACAD,QAAIN,MAAJ,GAAa,GAAb;AACAK,SAAKC,GAAL;AACD,GAJD;;AAMA;AACA/B,MAAIW,GAAJ,CAAQ,CAACoB,GAAD,EAAMb,GAAN,EAAWC,GAAX,EAAgBW,IAAhB,KAAyB;AAC/B;AACAX,QAAIc,MAAJ,CAAWC,OAAX,GAAqBH,IAAIG,OAAzB;AACAf,QAAIc,MAAJ,CAAWE,KAAX,GAAmBjB,IAAIlB,GAAJ,CAAQiB,GAAR,CAAY,KAAZ,MAAuB,aAAvB,GAAuCc,GAAvC,GAA6C,EAAhE;;AAEA;AACAZ,QAAIM,MAAJ,CAAWM,IAAIN,MAAJ,IAAc,GAAzB;AACAN,QAAIiB,MAAJ,CAAW,OAAX;AACD,GARD;AAUD;;;;;;;;AC5ED,oC;;;;;;ACAA,iC;;;;;;ACAA,mC;;;;;;ACAA,wC;;;;;;ACAA,sC;;;;;;ACAA,iC;;;;;;;ACAA;AAAA,MAAMC,aAAa;AACjBC,eAAa,WADI;AAEjBC,kBAAgB;AAFC,CAAnB;AAIA;AACA,0EAAeF,UAAf,E;;;;;;;;;ACLA;AACA,MAAM3C,WAAW,IAAI,iEAAJ,CAAa,IAAI8C,GAAJ,EAAb,CAAjB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACDA;;AAEA;;IAEMC,Q,aAAN,MAAMA,QAAN,CAAe;AAEbC,cAAYC,eAAZ,EAA6B;AAAA,SAD7BC,YAC6B,GADd,IACc;;AAC3B,SAAKA,YAAL,GAAoB,wDAAAC,CAAWF,eAAX,CAApB;AACD;;AAGDrB,cAAYxB,QAAZ,EAAsB;AACpB;AACA,SAAKgD,WAAL,CAAiBhD,QAAjB;AACD;;AAGDgD,cAAYhD,QAAZ,EAAsB;AACpB,SAAK8C,YAAL,CAAkBG,GAAlB,CAAsBjD,SAASkD,EAA/B,EAAmClD,QAAnC;AACD;;AAGD,MAAIH,WAAJ,GAAkB;AAChB,WAAO,KAAKiD,YAAZ;AACD;;AAGD,MAAIK,cAAJ,GAAqB;AACnB,UAAMC,SAAS,EAAf;AACA,SAAK,MAAM,CAACC,GAAD,EAAM,EAACC,KAAD,EAAQC,QAAR,EAAN,CAAX,IAAuC,KAAK1D,WAA5C,EAAyD;AACvDc,cAAQC,GAAR,CAAY2C,QAAZ;AACAH,aAAOI,IAAP,CAAY;AACVC,cAAM,SADI;AAEVC,oBAAY;AACVC,gBAAM,2DAAAC,CAAUP,GAAV,EAAeM,IADX;AAEVL,eAFU;AAGVC;AAHU,SAFF;AAOVM,kBAAU;AACRJ,gBAAM,SADE;AAERK,uBAAa,CAAC,2DAAAF,CAAUP,GAAV,EAAeS,WAAhB;AAFL;AAPA,OAAZ;AAYD;AACD,WAAOV,MAAP;AACD;AAzCY,C,+DAMZ,4C,oJAMA,4C,oJAKA,8C,uJAKA,8C;;;AAsBH;AACA,0EAAeT,QAAf,E;;;;;;;ACjDA,MAAMiB,YAAY;AAChB,KAAG;AACDD,UAAM,QADL;AAEDG,iBAAa,CACX,CAAC,QAAD,EAAW,CAAC,OAAZ,CADW,EAEX,CAAC,QAAD,EAAW,CAAC,OAAZ,CAFW,EAGX,CAAC,QAAD,EAAW,CAAC,OAAZ,CAHW,EAIX,CAAC,QAAD,EAAW,CAAC,OAAZ,CAJW,EAKX,CAAC,QAAD,EAAW,CAAC,OAAZ,CALW;AAFZ,GADa;AAWhB,KAAG;AACDA,iBAAa,CACX,CAAC,CAAC,OAAF,EAAU,QAAV,CADW,EAEX,CAAC,CAAC,OAAF,EAAU,QAAV,CAFW,EAGX,CAAC,CAAC,OAAF,EAAU,QAAV,CAHW,EAIX,CAAC,CAAC,OAAF,EAAU,QAAV,CAJW,EAKX,CAAC,CAAC,OAAF,EAAU,QAAV,CALW;AADZ,GAXa;AAoBhB,KAAG;AACDH,UAAM,QADL;AAEDG,iBAAa,CACX,CAAC,CAAC,OAAF,EAAU,QAAV,CADW,EAEX,CAAC,CAAC,OAAF,EAAU,QAAV,CAFW,EAGX,CAAC,CAAC,OAAF,EAAU,QAAV,CAHW,EAIX,CAAC,CAAC,OAAF,EAAU,QAAV,CAJW,EAKX,CAAC,CAAC,OAAF,EAAU,QAAV,CALW;AAFZ,GApBa;AA8BhB,KAAG;AACDH,UAAM,QADL;AAEDG,iBAAa,CACX,CAAC,CAAC,OAAF,EAAU,QAAV,CADW,EAEX,CAAC,CAAC,OAAF,EAAU,QAAV,CAFW,EAGX,CAAC,CAAC,OAAF,EAAU,QAAV,CAHW,EAIX,CAAC,CAAC,OAAF,EAAU,QAAV,CAJW,EAKX,CAAC,CAAC,OAAF,EAAU,QAAV,CALW;AAFZ,GA9Ba;AAwChB,KAAG;AACDH,UAAM,QADL;AAEDG,iBAAa,CACX,CAAC,CAAC,OAAF,EAAU,QAAV,CADW,EAEX,CAAC,CAAC,OAAF,EAAU,QAAV,CAFW,EAGX,CAAC,CAAC,OAAF,EAAU,QAAV,CAHW,EAIX,CAAC,CAAC,OAAF,EAAU,QAAV,CAJW,EAKX,CAAC,CAAC,OAAF,EAAU,QAAV,CALW;AAFZ;AAxCa,CAAlB;;AAoDA,yDAAeF,SAAf,E","file":"backend-compiled-debug.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 5022bb346843c0a10367","module.exports = require(\"mobx\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mobx\"\n// module id = 0\n// module chunks = 0","import { setupServer } from './setupServer';\r\nimport { mapState } from './shared/state/appState';\r\nlet envPort = process.env.PORT || 8080;\r\nsetupServer(mapState, envPort);\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import express from 'express';\r\nimport path from 'path';\r\nimport logger from 'morgan';\r\nimport bodyParser from 'body-parser';\r\nimport SocketIo from 'socket.io';\r\nimport http from 'http';\r\nimport { autorun } from 'mobx'; \r\nimport { allRoomDataKey } from './shared/socket-keys';\r\nfunction createJsonFromMapState(mapState) {\r\n  return mapState.allRoomData.values().map(\r\n    roomData => {\r\n      return roomData;\r\n    }\r\n  )\r\n}\r\nfunction setupServer(mapState, port) {\r\n\r\n  const app = express();\r\n\r\n  const server = http.Server(app);\r\n\r\n  const io = SocketIo(server);\r\n\r\n  server.listen(port, undefined, undefined, () => {\r\n    console.log(\"Server running on port \" + port);\r\n  });\r\n  // uncomment after placing your favicon in /public\r\n  //app.use(favicon(path.join(__dirname, 'public', 'favicon.ico')));\r\n  app.use(logger('dev'));\r\n  app.use(bodyParser.json());\r\n  app.use(bodyParser.urlencoded({ extended: false }));\r\n\r\n  app.get('/', (req, res) => {\r\n    res.json({ hello: 'world' });\r\n  });\r\n\r\n  app.post('/devices', (req, res) => {\r\n    mapState.addRoomData(req.body);\r\n    console.info(req.body);\r\n    res.status(204);\r\n  });\r\n\r\n  autorun(()=>{\r\n    io.emit(\r\n     allRoomDataKey,\r\n     createJsonFromMapState(mapState)\r\n    );\r\n  });\r\n\r\n  io.on('connection', (socket) => {\r\n    console.info(\"Client connected\");\r\n    socket.emit(\r\n      allRoomDataKey,\r\n      createJsonFromMapState(mapState)\r\n    );\r\n  })\r\n\r\n\r\n  // catch 404 and forward to error handler\r\n  app.use((req, res, next) => {\r\n    var err = new Error('Not Found');\r\n    err.status = 404;\r\n    next(err);\r\n  });\r\n\r\n  // error handler\r\n  app.use((err, req, res, next) => {\r\n    // set locals, only providing error in development\r\n    res.locals.message = err.message;\r\n    res.locals.error = req.app.get('env') === 'development' ? err : {};\r\n\r\n    // render the error page\r\n    res.status(err.status || 500);\r\n    res.render('error');\r\n  });\r\n\r\n}\r\n\r\nexport { setupServer };\n\n\n// WEBPACK FOOTER //\n// ./src/setupServer.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 3\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"socket.io\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"socket.io\"\n// module id = 7\n// module chunks = 0","module.exports = require(\"http\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"http\"\n// module id = 8\n// module chunks = 0","const socketKeys = {\r\n  roomDataKey: 'room_data',\r\n  allRoomDataKey: 'all_room_data'\r\n}\r\nexport { socketKeys };\r\nexport default socketKeys;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/shared/socket-keys.js","import { MapState } from '../model/MapState';\r\nconst mapState = new MapState(new Map());\r\nexport { mapState };  \n\n\n// WEBPACK FOOTER //\n// ./src/shared/state/appState.jsx","import { observable, computed, action } from 'mobx';\r\n\r\nimport LOCATIONS from './LOCATIONS';\r\n\r\nclass MapState {\r\n  allRoomState = null;\r\n  constructor(initialRoomData) {\r\n    this.allRoomState = observable(initialRoomData);\r\n  }\r\n\r\n  @action\r\n  addRoomData(roomData) {\r\n    // TODO: Change this? Maybe keep a record of all room data across time.\r\n    this.setRoomData(roomData);\r\n  }\r\n\r\n  @action\r\n  setRoomData(roomData) {\r\n    this.allRoomState.set(roomData.id, roomData);\r\n  }\r\n\r\n  @computed\r\n  get allRoomData() {\r\n    return this.allRoomState;\r\n  }\r\n\r\n  @computed\r\n  get allRoomGeoData() {\r\n    const result = [];\r\n    for (const [key, {count, capacity}] of this.allRoomData) {\r\n      console.log(capacity);\r\n      result.push({\r\n        type: 'Feature',\r\n        properties: {\r\n          name: LOCATIONS[key].name,\r\n          count,\r\n          capacity\r\n        },\r\n        geometry: {\r\n          type: 'Polygon',\r\n          coordinates: [LOCATIONS[key].coordinates]\r\n        }\r\n      });\r\n    }\r\n    return result;\r\n  }\r\n}\r\n\r\nexport { MapState };\r\nexport default MapState;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/shared/model/MapState.jsx","const LOCATIONS = {\r\n  0: {\r\n    name: 'Room 0',\r\n    coordinates: [\r\n      [144.9628, -37.8165],\r\n      [144.9628, -37.8163],\r\n      [144.9627, -37.8163],\r\n      [144.9627, -37.8165],\r\n      [144.9628, -37.8165]\r\n    ]\r\n  },\r\n  1: {\r\n    coordinates: [\r\n      [-37.8165,144.9628],\r\n      [-37.8163,144.9628],\r\n      [-37.8163,144.9627],\r\n      [-37.8165,144.9627],\r\n      [-37.8165,144.9628]\r\n    ]\r\n  },\r\n  2: {\r\n    name: 'Room 0',\r\n    coordinates: [\r\n      [-37.8161,144.9624],\r\n      [-37.8159,144.9624],\r\n      [-37.8159,144.9623],\r\n      [-37.8161,144.9623],\r\n      [-37.8161,144.9624]\r\n    ]\r\n  },\r\n  3: {\r\n    name: 'Room 0',\r\n    coordinates: [\r\n      [-37.8158,144.9621],\r\n      [-37.8156,144.9621],\r\n      [-37.8156,144.9620],\r\n      [-37.8158,144.9620],\r\n      [-37.8158,144.9621]\r\n    ]\r\n  },\r\n  4: {\r\n    name: 'Room 0',\r\n    coordinates: [\r\n      [-37.8153,144.9616],\r\n      [-37.8151,144.9616],\r\n      [-37.8151,144.9615],\r\n      [-37.8153,144.9615],\r\n      [-37.8153,144.9616]\r\n    ]\r\n  }\r\n};\r\n\r\nexport default LOCATIONS;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/shared/model/LOCATIONS.js"],"sourceRoot":""}